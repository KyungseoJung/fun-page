<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ÏÑ†ÌÉùÌïòÏãúÍ≤†ÏäµÎãàÍπå?</title>
  <style>
    :root{
      --bg1:#0a2a1a;   /* deep green */
      --bg2:#4b2a1b;   /* cocoa brown */
      --bg3:#ff6fb3;   /* pink */
      --card: rgba(18,26,43,0.55);
      --stroke: rgba(255,255,255,0.12);
      --text:#eef3ff;
      --muted:#c8d4f0;
      --shadow: 0 18px 70px rgba(0,0,0,0.45);
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      color:var(--text);
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans KR", Arial, sans-serif;
      overflow:hidden;

      background:
        radial-gradient(800px 520px at 30% 30%, rgba(255,111,179,0.55), transparent 65%),
        radial-gradient(900px 600px at 70% 25%, rgba(10,42,26,0.70), transparent 60%),
        radial-gradient(900px 700px at 55% 80%, rgba(75,42,27,0.65), transparent 60%),
        linear-gradient(135deg, #06140d 0%, #1b0f0a 55%, #120616 100%);
    }

    .card{
      width:min(640px, 92vw);
      min-height: 360px;
      padding:40px 28px;
      background: var(--card);
      border: 1px solid var(--stroke);
      border-radius: 20px;
      box-shadow: var(--shadow);
      text-align:center;
      backdrop-filter: blur(10px);
      position: relative;
      overflow:hidden;
    }

    h1{
      margin:0 0 10px;
      font-size: 30px;
      letter-spacing: -0.6px;
    }
    p{
      margin:0 0 26px;
      color: var(--muted);
      font-size: 14px;
    }

    .btn-area{
      position: relative;
      width: 100%;
      height: 90px;
      display:flex;
      align-items:center;
      justify-content:center;
      gap: 14px;
    }

    button{
      border:0;
      padding: 12px 18px;
      border-radius: 12px;
      font-size: 16px;
      cursor: pointer;
      transition: transform 140ms ease, filter 140ms ease;
      min-width: 110px;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
      position: relative;
      z-index: 2;
    }
    #yesBtn{
      background: rgba(255,111,179,0.55);
      color: white;
      border: 1px solid rgba(255,255,255,0.18);
    }
    #yesBtn:hover{ filter: brightness(1.05); transform: translateY(-1px); }

    #noBtn{
      background: rgba(200,255,212,0.18);
      color: var(--text);
      border: 1px solid rgba(255,255,255,0.16);
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(calc(-50% + 140px), -50%);
      z-index: 3;
      will-change: left, top, transform;
    }
    #noBtn:hover{ filter: brightness(1.08); }

    .hidden{ display:none; }

    /* ====== Í≤∞Í≥º ÌôîÎ©¥ ====== */
    .stage{
      position: relative;
      width: 100%;
      height: 420px;
      display:flex;
      align-items:center;
      justify-content:center;
      flex-direction: column;
      gap: 14px;
    }

    .sparkles{
      position:absolute;
      inset:0;
      z-index:0;
      opacity: 0.25;
      pointer-events:none;
      background:
        radial-gradient(2px 2px at 20% 30%, rgba(255,255,255,0.35), transparent 60%),
        radial-gradient(2px 2px at 60% 18%, rgba(255,255,255,0.25), transparent 60%),
        radial-gradient(2px 2px at 78% 42%, rgba(255,255,255,0.30), transparent 60%),
        radial-gradient(2px 2px at 30% 70%, rgba(255,255,255,0.22), transparent 60%),
        radial-gradient(2px 2px at 85% 78%, rgba(255,255,255,0.26), transparent 60%);
    }

    #fx{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      z-index: 1;
      pointer-events:none;
    }

    .cake-wrap{
      position: relative;
      width: 320px;
      height: 250px;
      display:flex;
      align-items:flex-end;
      justify-content:center;
      z-index: 2;
      filter: drop-shadow(0 10px 18px rgba(0,0,0,0.35));
    }

    .plate{
      position:absolute;
      bottom: 0;
      width: 320px;
      height: 18px;
      border-radius: 999px;
      background: rgba(255,255,255,0.18);
      border: 1px solid rgba(255,255,255,0.16);
      backdrop-filter: blur(6px);
    }

    /* ÏºÄÏù¥ÌÅ¨ Ï∏µ */
    .tier{
      position:absolute;
      left: 50%;
      transform: translateX(-50%) translateY(120px);
      opacity: 0;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,0.16);
      box-shadow: 0 10px 22px rgba(0,0,0,0.28);
      transition: transform 520ms cubic-bezier(.2,.9,.2,1), opacity 520ms ease;
      overflow:hidden;

      background:
        linear-gradient(180deg, rgba(255,232,245,0.35), rgba(255,232,245,0.10)),
        linear-gradient(90deg, rgba(255,255,255,0.10), rgba(255,255,255,0.02));
      backdrop-filter: blur(4px);
    }

    .t1{ width: 260px; height: 54px; bottom: 18px;
      background:
        linear-gradient(180deg, rgba(255,224,240,0.40), rgba(255,224,240,0.12)),
        linear-gradient(180deg, rgba(92,48,26,0.22), rgba(92,48,26,0.06));
    }
    .t2{ width: 230px; height: 50px; bottom: 72px;
      background:
        linear-gradient(180deg, rgba(200,255,212,0.26), rgba(200,255,212,0.08)),
        linear-gradient(180deg, rgba(92,48,26,0.18), rgba(92,48,26,0.05));
    }
    .t3{ width: 200px; height: 46px; bottom: 122px;
      background:
        linear-gradient(180deg, rgba(255,214,184,0.28), rgba(255,214,184,0.10)),
        linear-gradient(180deg, rgba(92,48,26,0.16), rgba(92,48,26,0.05));
    }
    .t4{ width: 170px; height: 42px; bottom: 168px;
      background:
        linear-gradient(180deg, rgba(255,232,245,0.32), rgba(255,232,245,0.10)),
        linear-gradient(180deg, rgba(92,48,26,0.14), rgba(92,48,26,0.04));
    }
    .t5{ width: 140px; height: 38px; bottom: 210px;
      background:
        linear-gradient(180deg, rgba(200,255,212,0.24), rgba(200,255,212,0.08)),
        linear-gradient(180deg, rgba(92,48,26,0.12), rgba(92,48,26,0.04));
    }

    /* ÌÅ¨Î¶º ÎìúÎ¶Ω */
    .tier::before{
      content:"";
      position:absolute;
      left:-10%;
      right:-10%;
      top:-8px;
      height: 22px;
      border-radius: 0 0 16px 16px;
      background:
        radial-gradient(14px 12px at 10% 55%, rgba(255,255,255,0.35), transparent 60%),
        radial-gradient(18px 14px at 25% 60%, rgba(255,255,255,0.28), transparent 60%),
        radial-gradient(16px 12px at 42% 58%, rgba(255,255,255,0.30), transparent 60%),
        radial-gradient(20px 16px at 60% 62%, rgba(255,255,255,0.26), transparent 60%),
        radial-gradient(16px 12px at 78% 58%, rgba(255,255,255,0.30), transparent 60%),
        radial-gradient(18px 14px at 92% 62%, rgba(255,255,255,0.26), transparent 60%),
        linear-gradient(180deg, rgba(255,255,255,0.28), rgba(255,255,255,0.12));
      opacity: 0.95;
    }

    /* Ïä§ÌîÑÎßÅÌÅ¥ */
    .tier::after{
      content:"";
      position:absolute;
      inset: 0;
      background:
        radial-gradient(2px 2px at 18% 60%, rgba(255,111,179,0.55), transparent 60%),
        radial-gradient(2px 2px at 32% 70%, rgba(200,255,212,0.50), transparent 60%),
        radial-gradient(2px 2px at 46% 62%, rgba(255,214,184,0.55), transparent 60%),
        radial-gradient(2px 2px at 58% 72%, rgba(255,111,179,0.45), transparent 60%),
        radial-gradient(2px 2px at 70% 64%, rgba(200,255,212,0.45), transparent 60%),
        radial-gradient(2px 2px at 82% 70%, rgba(255,214,184,0.50), transparent 60%);
      opacity: 0.9;
      pointer-events:none;
    }

    .tier.on{
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }

    .candle{
      position:absolute;
      left: 50%;
      bottom: 250px;
      transform: translateX(-50%) translateY(40px);
      width: 16px;
      height: 40px;
      border-radius: 10px;
      background: rgba(255,255,255,0.22);
      border: 1px solid rgba(255,255,255,0.18);
      opacity: 0;
      transition: transform 500ms cubic-bezier(.2,.9,.2,1), opacity 500ms ease;
      z-index: 3;
    }
    .candle.on{ opacity:1; transform: translateX(-50%) translateY(0); }
    .flame{
      position:absolute;
      left: 50%;
      top: -14px;
      transform: translateX(-50%);
      width: 12px;
      height: 16px;
      border-radius: 999px;
      background: rgba(255,255,255,0.28);
      animation: flame 0.9s infinite ease-in-out;
    }
    @keyframes flame{
      0%,100%{ transform: translateX(-50%) scale(1); opacity: .9; }
      50%{ transform: translateX(-50%) scale(0.85); opacity: .6; }
    }

    /* ÌÜ†Ìïë(Ï≤¥Î¶¨/Îî∏Í∏∞ ÎäêÎÇå) */
    .topping{
      position:absolute;
      left: 50%;
      bottom: 238px;
      transform: translateX(-50%) translateY(18px);
      width: 26px;
      height: 22px;
      border-radius: 999px;
      background: rgba(255,111,179,0.55);
      border: 1px solid rgba(255,255,255,0.18);
      box-shadow: 0 10px 18px rgba(0,0,0,0.25);
      opacity: 0;
      transition: transform 520ms cubic-bezier(.2,.9,.2,1), opacity 520ms ease;
      z-index: 3;
    }
    .topping::before{
      content:"";
      position:absolute;
      left: 50%;
      top:-10px;
      transform: translateX(-50%);
      width: 10px; height: 12px;
      border-radius: 999px;
      background: rgba(200,255,212,0.45);
      border: 1px solid rgba(255,255,255,0.14);
    }
    .topping.on{ opacity:1; transform: translateX(-50%) translateY(0); }

    .happy{
      z-index: 3;
      margin-top: 10px;
      font-size: clamp(28px, 5vw, 44px);
      font-weight: 900;
      letter-spacing: -1px;
      opacity: 0;
      transform: translateY(10px) scale(0.98);
      transition: opacity 700ms ease, transform 700ms cubic-bezier(.2,.9,.2,1);
      text-shadow: 0 10px 26px rgba(0,0,0,0.35);
    }
    .happy.on{
      opacity: 1;
      transform: translateY(0) scale(1);
    }
    .happy span{
      display:inline-block;
      animation: pop 1.2s ease-in-out infinite;
    }
    @keyframes pop{
      0%,100%{ transform: translateY(0); }
      50%{ transform: translateY(-3px); }
    }
  </style>
</head>

<body>
  <div class="card">
    <div class="sparkles"></div>

    <!-- ÏßàÎ¨∏ ÌôîÎ©¥ -->
    <div id="questionView">
      <h1>ÏÑ†ÌÉùÌïòÏãúÍ≤†ÏäµÎãàÍπå?</h1>
      <p>ÏïÑÎãàÏò§Î•º ÎàÑÎ•¥Î†§Í≥† ÌïòÎ©¥‚Ä¶ ÌôîÎ©¥ ÏïàÏóêÏÑúÎßå ÎèÑÎßùÍ∞ëÎãàÎã§ üòà</p>

      <div class="btn-area" id="btnArea">
        <button id="yesBtn" type="button">Ïòà</button>
        <button id="noBtn" type="button">ÏïÑÎãàÏò§</button>
      </div>
    </div>

    <!-- Í≤∞Í≥º ÌôîÎ©¥ -->
    <div id="resultView" class="hidden">
      <div class="stage">
        <canvas id="fx"></canvas>

        <div class="cake-wrap" aria-label="cake animation">
          <div class="plate"></div>

          <div class="tier t1"></div>
          <div class="tier t2"></div>
          <div class="tier t3"></div>
          <div class="tier t4"></div>
          <div class="tier t5"></div>

          <div class="candle" id="candle">
            <div class="flame"></div>
          </div>

          <div class="topping" aria-hidden="true"></div>
        </div>

        <div class="happy" id="happyText">
          <span>H</span><span>a</span><span>p</span><span>p</span><span>y</span>
          <span>&nbsp;</span>
          <span>0</span><span>0</span><span>0</span><span>!!!</span>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ====== 1) "ÏïÑÎãàÏò§" Î≤ÑÌäº: ÌôîÎ©¥ Î∞ñÏúºÎ°ú Ï†àÎåÄ Ïïà ÎÇòÍ∞ÄÍ≤å + Í∑ºÏ≤ò Ïò§Î©¥ ÏàúÍ∞ÑÏù¥Îèô ======
    const yesBtn = document.getElementById("yesBtn");
    const noBtn = document.getElementById("noBtn");
    const btnArea = document.getElementById("btnArea");

    function rand(min, max){ return Math.random() * (max - min) + min; }

    function placeNoButtonWithinArea(preferAwayFrom){
      const areaRect = btnArea.getBoundingClientRect();
      const btnRect  = noBtn.getBoundingClientRect();

      const pad = 8;
      const minX = pad;
      const minY = pad;
      const maxX = Math.max(pad, areaRect.width  - btnRect.width  - pad);
      const maxY = Math.max(pad, areaRect.height - btnRect.height - pad);

      let x = rand(minX, maxX);
      let y = rand(minY, maxY);

      if (preferAwayFrom) {
        const tries = 10;
        let best = {x, y, score: -1};

        for (let i=0; i<tries; i++){
          const tx = rand(minX, maxX);
          const ty = rand(minY, maxY);

          const btnCenterX = areaRect.left + tx + btnRect.width/2;
          const btnCenterY = areaRect.top  + ty + btnRect.height/2;

          const dx = btnCenterX - preferAwayFrom.x;
          const dy = btnCenterY - preferAwayFrom.y;
          const score = Math.hypot(dx, dy);

          if (score > best.score) best = {x: tx, y: ty, score};
        }
        x = best.x; y = best.y;
      }

      noBtn.style.left = `${x}px`;
      noBtn.style.top  = `${y}px`;
      noBtn.style.transform = `translate(0, 0)`;
    }

    window.addEventListener("load", () => placeNoButtonWithinArea(null));
    window.addEventListener("resize", () => placeNoButtonWithinArea(null));

    function handlePointerMove(clientX, clientY){
      const btnRect = noBtn.getBoundingClientRect();
      const cx = btnRect.left + btnRect.width/2;
      const cy = btnRect.top  + btnRect.height/2;
      const dist = Math.hypot(cx - clientX, cy - clientY);

      const trigger = 120;
      if (dist < trigger){
        placeNoButtonWithinArea({x: clientX, y: clientY});
      }
    }

    document.addEventListener("mousemove", (e) => {
      handlePointerMove(e.clientX, e.clientY);
    }, {passive:true});

    document.addEventListener("touchmove", (e) => {
      const t = e.touches[0];
      if (!t) return;
      handlePointerMove(t.clientX, t.clientY);
    }, {passive:true});

    // ====== 2) Ïòà ÌÅ¥Î¶≠: ÏºÄÏù¥ÌÅ¨ ÏåìÍ∏∞ -> Ï¥õÎ∂à+ÌÜ†Ìïë -> Ìè≠Ï£Ω -> ÌÖçÏä§Ìä∏ ======
    const questionView = document.getElementById("questionView");
    const resultView   = document.getElementById("resultView");

    const tiers = Array.from(document.querySelectorAll(".tier"));
    const candle = document.getElementById("candle");
    const topping = document.querySelector(".topping");
    const happyText = document.getElementById("happyText");

    const canvas = document.getElementById("fx");
    const ctx = canvas.getContext("2d", { alpha: true });

    function resizeCanvas(){
      const rect = canvas.getBoundingClientRect();
      const dpr = Math.max(1, window.devicePixelRatio || 1);
      canvas.width = Math.floor(rect.width * dpr);
      canvas.height = Math.floor(rect.height * dpr);
      ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
    }
    window.addEventListener("resize", resizeCanvas);

    let particles = [];
    function spawnFirework(){
      const rect = canvas.getBoundingClientRect();
      const x = rand(rect.width * 0.2, rect.width * 0.8);
      const y = rand(rect.height * 0.12, rect.height * 0.45);

      const count = Math.floor(rand(36, 64));
      for (let i=0; i<count; i++){
        const a = rand(0, Math.PI * 2);
        const sp = rand(2.0, 5.0);
        particles.push({
          x, y,
          vx: Math.cos(a) * sp,
          vy: Math.sin(a) * sp,
          life: rand(38, 65),
          size: rand(1.5, 2.8),
          alpha: 1
        });
      }
    }

    function stepFireworks(){
      const rect = canvas.getBoundingClientRect();
      ctx.clearRect(0, 0, rect.width, rect.height);

      ctx.fillStyle = "rgba(0,0,0,0.10)";
      ctx.fillRect(0, 0, rect.width, rect.height);

      const gravity = 0.06;
      particles = particles.filter(p => p.life > 0);

      for (const p of particles){
        p.vy += gravity;
        p.x += p.vx;
        p.y += p.vy;
        p.life -= 1;
        p.alpha = Math.max(0, p.life / 65);

        ctx.beginPath();
        ctx.fillStyle = `rgba(255,255,255,${0.75 * p.alpha})`;
        ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
        ctx.fill();
      }

      requestAnimationFrame(stepFireworks);
    }

    function delay(ms){ return new Promise(res => setTimeout(res, ms)); }

    async function playShow(){
      questionView.classList.add("hidden");
      resultView.classList.remove("hidden");

      resizeCanvas();
      particles = [];
      requestAnimationFrame(stepFireworks);

      // reset
      tiers.forEach(t => t.classList.remove("on"));
      candle.classList.remove("on");
      topping?.classList.remove("on");
      happyText.classList.remove("on");

      // stack tiers
      for (let i=0; i<tiers.length; i++){
        tiers[i].classList.add("on");
        await delay(420);
      }

      // candle + topping
      candle.classList.add("on");
      topping?.classList.add("on");
      await delay(350);

      // fireworks
      for (let i=0; i<8; i++){
        spawnFirework();
        await delay(220);
      }

      // text
      happyText.classList.add("on");
    }

    yesBtn.addEventListener("click", playShow);
  </script>
</body>
</html>
